{% extends "eCoffee/layout.html" %} 
<!-- {% load static %} -->
{%block title%}Cart Page{%endblock%} 
{%block body %}

<div class="cart-container">
   <h1>YOUR CART</h1>
   {%if items %}
   <div class="row mb-2">
      <div class="col-md-7 mr-5">
         {%for item in items %}
         <div class="row">
            <div class="d-flex justify-content-between w-100">
               <div class="d-flex justify-content-center">
                  <img src="{{ item.product.photo_url }}" width="150" height="110" alt="coffee" class="mr-1"/>
                  <p>{{item.product.description}}</p></div>
               <h5 class="subtotal">${{item.sub_total}}</h5>
                 
            </div>
         </div>
         <div class="row">
            <div class="d-flex justify-content-end w-100">              
               <div class="d-flex">
                  <form method="POST" action="{% url 'cart_delete_item' item.product.id %}">
                     {%csrf_token%}
                  <button type="submit" class="remove-btn">Remove All</button>
                  </form>
                  <form method="POST" action="{% url "update_cart_item" item.product.id %}">
                     {%csrf_token%}
                     <input type="hidden" name="three" value="{{ request.path }}"/>
                  <button 
                           type="submit"
                           class="modify-quantity"
                           name="modify_quantity"
                           value="decrease"
                        >-</button>
                  <input type="number" name="quantity" min="1" max="10" value="{{ item.quantity }}" onchange="" class="modify-quantity"/>
                  <button
                        type="submit"
                        class="modify-quantity"
                        name="modify_quantity"
                        value="increase">+</button>
                  </form>
               </div>
            </div>
         </div>
         <hr class="my-5"/>
         {%endfor%}
      </div>
      <div class="col-md-4 mx-4 amount">
         <div class="d-flex justify-content-between">
            <h5>Subtotal</h5>
            {%if sum_sub_total%}
            <h5 class="subtotal">${{sum_sub_total}}</h5>
            {%endif%}
         </div>
         <div class="divider"></div>

         <div class="d-flex justify-content-between mt-f4">
            <h5>Taxes:</h5>
            {%if taxes%}
            <h5 class="subtotal">${{taxes|floatformat:2 }}</h5>
            {%endif%}
         </div>
         <div class="d-flex justify-content-between">
            <p class="taxes">5% GST:</p>
            {%if tax5 %}
            <p class="subtotal">${{tax5|floatformat:2}}</p>
            {%endif%}
         </div>
         <div class="d-flex justify-content-between">
            <p class="taxes">7% HST:</p>
            {%if tax7|floatformat:2 %}
            <p class="subtotal">${{tax7|floatformat:2 }}</p>
            {%endif%}
         </div>
         <div class="divider"></div>
         <div class="d-flex justify-content-between mt-3">
            <h5>Estimated:</h5>
            {%if total %}
            <h5 class="total">${{total|floatformat:2 }}</h5>
            {%endif%}
         </div>
         <div class="d-flex justify-content-center">
            <form action="{% url 'create_checkout_session' %}" method="POST">
               {%csrf_token%}
               <input type="hidden" name="total" value="{{ total|floatformat:2 }}"/>
               <input type="hidden" name="cart_length" value="{{ cart_length }}"/>
               <button class="checkout-btn" type="submit">Continue to Checkout</button>
            </form>
         </div>
      </div>
   </div>   
   
   {%else%}
   <p>No items added yet.</p>
   {%endif%}
</div>

{%endblock%}